module Integrator

    function RK4(g0, f0, g1, f1, y0, y1, h)
        #1 stands for the element i in the arrays
        #2 stands for the element i+1 in the arrays
        k01=h*(f0[1]*y1 + g0[1])
        k11=h*(f1[1]*y0 + g1[1])

        k02=h*(0.5*(f0[1] + f0[2])*(y1+0.5*k11) +0.5*(g0[1] + g0[2]))
        k12=h*(0.5*(f1[1] + f1[2])*(y0+0.5*k01) +0.5*(g1[1] + g1[2]))

        k03=h*(0.5*(f0[1] + f0[2])*(y1+0.5*k12) +0.5*(g0[1] + g0[2]))
        k13=h*(0.5*(f1[1] + f1[2])*(y0+0.5*k02) +0.5*(g1[1] + g1[2]))

        k04=h*(f0[2]*(y1 + k13) + g0[2])
        k14=h*(f1[2]*(y0 + k03) + g1[2])

        y0p= y0 + (1.0/6.0)*(k01 + 2.0*k02 + 2.0*k03 + k04)
        y1p= y1 + (1.0/6.0)*(k11 + 2.0*k12 + 2.0*k13 + k14)

        return y0p, y1p
        
    end

    function PCAM4(g0, f0, g1, f1, y0, y1, h)
        yp0= y0[4] + (h/24.0)*(55.0*(y1[4]*f0[4] + g0[4]) -59.0*(y1[3]*f0[3] + g0[3]) 
                                +37.0*(y1[2]*f0[2] + g0[2]) -9.0*(y1[1]*f0[1] + g0[1]))
        yp1= y1[4] + (h/24.0)*(55.0*(y0[4]*f1[4] + g1[4]) -59.0*(y0[3]*f1[3] + g1[3]) 
                                +37.0*(y0[2]*f1[2] + g1[2]) -9.0*(y0[1]*f1[1] + g1[1]))

        yc0= y0[4] + (h/24.0)*(9.0*(yp1*f0[5] + g0[5]) +19.0*(y1[4]*f0[4] + g0[4]) 
                                -5.0*(y1[3]*f0[3] + g0[3]) +(y1[2]*f0[2] + g0[2]))
        yc1= y1[4] + (h/24.0)*(9.0*(yp0*f1[5] + g1[5]) +19.0*(y0[4]*f1[4] + g1[4]) 
                                -5.0*(y0[3]*f1[3] + g1[3]) +(y0[2]*f1[2] + g1[2]))

        return yc0, yc1
    end

    function PCABM5(g0, f0, g1, f1, y0, y1, h)
        yp0= y0[5] + (h/720.0)*(1901.0*(y1[5]*f0[5] + g0[5]) 
                                -2774.0*(y1[4]*f0[4] + g0[4]) +2616.0*(y1[3]*f0[3] + g0[3]) 
                                -1274.0*(y1[2]*f0[2] + g0[2]) +251.0*(y1[1]*f0[1] + g0[1]))

        yp1= y1[5] + (h/720.0)*(1901.0*(y0[5]*f1[5] + g1[5]) 
                                -2774.0*(y0[4]*f1[4] + g1[4]) +2616.0*(y0[3]*f1[3] + g1[3]) 
                                -1274.0*(y0[2]*f1[2] + g1[2]) +251.0*(y0[1]*f1[1] + g1[1]))


        yc0= y0[5] + (h/720.0)*(251.0*(yp1*f0[6] + g0[6]) 
                                +646.0*(y1[5]*f0[5] + g0[5]) -264.0*(y1[4]*f0[4] + g0[4]) 
                                +106.0*(y1[3]*f0[3] + g0[3]) -19.0*(y1[2]*f0[2] + g0[2]))

        yc1= y1[5] + (h/720.0)*(251.0*(yp0*f1[6] + g1[6]) 
                                +646.0*(y0[5]*f1[5] + g1[5]) -264.0*(y0[4]*f1[4] + g1[4]) 
                                +106.0*(y0[3]*f1[3] + g1[3]) -19.0*(y0[2]*f1[2] + g1[2]))


        return yc0, yc1
    end

end
